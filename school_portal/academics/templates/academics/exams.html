{% extends 'base.html' %}
{% load static %}
{% block title %}Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª{% endblock %}

{% block content %}
<div class="container py-4" dir="rtl" lang="ar">
    <h2 class="text-primary fw-bold mb-4">ğŸ“ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</h2>

    {% if user.is_staff or user.role == 'teacher' %}
        <div class="mb-4">
            <a href="{% url 'academics:add_exam' %}" class="btn btn-success rounded-pill shadow-sm">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù…ØªØ­Ø§Ù† Ø¬Ø¯ÙŠØ¯</a>
        </div>
    {% endif %}

    <!-- ØµÙˆØ± Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª -->
    <div class="mb-4">
        <h5 class="fw-bold">ğŸ“… Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h5>
        <div class="row g-4">
            <!-- Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„ -->
            <div class="col-md-4 col-6 text-center">
                <h6 class="fw-bold mb-2">Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø£ÙˆÙ„</h6>
                <a href="{% static 'images/exam_1.png' %}" data-bs-toggle="modal" data-bs-target="#imageModal" data-img="{% static 'images/exam_1.png' %}">
                    <img src="{% static 'images/exam_1.png' %}" class="exam-schedule-img rounded shadow-sm" alt="Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø£ÙˆÙ„">
                </a>
            </div>

            <!-- Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ -->
            <div class="col-md-4 col-6 text-center">
                <h6 class="fw-bold mb-2">Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</h6>
                <a href="{% static 'images/exam_2.png' %}" data-bs-toggle="modal" data-bs-target="#imageModal" data-img="{% static 'images/exam_2.png' %}">
                    <img src="{% static 'images/exam_2.png' %}" class="exam-schedule-img rounded shadow-sm" alt="Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ">
                </a>
            </div>

            <!-- Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù„Ø« / Ø¥Ø¶Ø§ÙÙŠ -->
            <div class="col-md-4 col-6 text-center">
                <h6 class="fw-bold mb-2">Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø«Ø§Ù„Ø«</h6>
                <a href="{% static 'images/exam_schedule_month3.png' %}" data-bs-toggle="modal" data-bs-target="#imageModal" data-img="{% static 'images/exam_schedule_month3.png' %}">
                    <img src="{% static 'images/exam_schedule_month3.png' %}" class="exam-schedule-img rounded shadow-sm" alt="Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø«Ø§Ù„Ø«">
                </a>
            </div>
        </div>
    </div>

    <!-- Tabs Ù„Ù„ÙØµÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© -->
    <ul class="nav nav-tabs mb-3" id="examTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="first-semester-tab" data-bs-toggle="tab" data-bs-target="#first-semester" type="button" role="tab">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="second-semester-tab" data-bs-toggle="tab" data-bs-target="#second-semester" type="button" role="tab">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ</button>
        </li>
    </ul>

    <div class="tab-content" id="examTabsContent">
        <!-- Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„ -->
        <div class="tab-pane fade show active" id="first-semester" role="tabpanel">
            {% for exam in exams_first %}
                <div id="exam-{{ exam.id }}" class="list-group-item d-flex justify-content-between align-items-center mb-2 shadow-sm rounded-3 p-3">
                    <div>
                        <h5 class="mb-1 fw-bold">{{ exam.title }}</h5>
                        <small class="text-muted">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†: {{ exam.date|date:"d-m-Y" }}</small>
                        {% if exam.description %}
                            <p class="mb-0 text-secondary">{{ exam.description }}</p>
                        {% endif %}
                    </div>
                    <div class="text-end">
                        {% if user.is_staff or user.role == 'teacher' %}
                            <div class="d-flex gap-2 justify-content-end">
                                <a href="{% url 'exams:edit_exam' exam.id %}" class="btn btn-sm btn-outline-primary">âœ ØªØ¹Ø¯ÙŠÙ„</a>
                                <form action="{% url 'exams:delete_exam' exam.id %}" method="post" class="d-inline">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-sm btn-outline-danger">ğŸ—‘ Ø­Ø°Ù</button>
                                </form>
                            </div>
                        {% else %}
                            {% if exam.is_active %}
                                <a href="{% url 'exams:take_exam' exam.id %}" class="btn btn-sm btn-outline-success mt-2">ğŸ“ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</a>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>

        <!-- Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ -->
        <div class="tab-pane fade" id="second-semester" role="tabpanel">
            {% for exam in exams_second %}
                <div id="exam-{{ exam.id }}" class="list-group-item d-flex justify-content-between align-items-center mb-2 shadow-sm rounded-3 p-3">
                    <div>
                        <h5 class="mb-1 fw-bold">{{ exam.title }}</h5>
                        <small class="text-muted">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†: {{ exam.date|date:"d-m-Y" }}</small>
                        {% if exam.description %}
                            <p class="mb-0 text-secondary">{{ exam.description }}</p>
                        {% endif %}
                    </div>
                    <div class="text-end">
                        {% if user.is_staff or user.role == 'teacher' %}
                            <div class="d-flex gap-2 justify-content-end">
                                <a href="{% url 'exams:edit_exam' exam.id %}" class="btn btn-sm btn-outline-primary">âœ ØªØ¹Ø¯ÙŠÙ„</a>
                                <form action="{% url 'exams:delete_exam' exam.id %}" method="post" class="d-inline">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-sm btn-outline-danger">ğŸ—‘ Ø­Ø°Ù</button>
                                </form>
                            </div>
                        {% else %}
                            {% if exam.is_active %}
                                <a href="{% url 'exams:take_exam' exam.id %}" class="btn btn-sm btn-outline-success mt-2">ğŸ“ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</a>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <a href="{% url 'core:home' %}" class="btn btn-secondary mt-4 rounded-pill shadow-sm">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…Ø§Øª â¡</a>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ù„ØªÙƒØ¨ÙŠØ± Ø§Ù„ØµÙˆØ± -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content bg-transparent border-0">
      <div class="modal-body p-0">
        <img src="" id="modalImg" class="img-fluid rounded" alt="ØªÙƒØ¨ÙŠØ± Ø§Ù„ØµÙˆØ±Ø©">
      </div>
    </div>
  </div>
</div>

<!-- CSS Ù„Ù„ØµÙˆØ± -->
<style>
.exam-schedule-img {
    width: 100%;
    height: 250px; /* Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© ÙˆØ£ÙƒØ¨Ø± Ø­Ø¬Ù… Ù„Ù„ÙˆØ¶ÙˆØ­ */
    object-fit: cover;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
    border: 3px solid #0d6efd;
    border-radius: 10px;
}
.exam-schedule-img:hover {
    transform: scale(1.05);
    box-shadow: 0 0 20px rgba(13, 110, 253, 0.5);
}
</style>

<!-- Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ -->
<script>
const imageModal = document.getElementById('imageModal');
const modalImg = document.getElementById('modalImg');

imageModal.addEventListener('show.bs.modal', function (event) {
    const link = event.relatedTarget;
    const imgSrc = link.getAttribute('data-img');
    modalImg.src = imgSrc;
});
</script>

{% endblock %}
