{% extends 'base.html' %}
{% load static %}

{% block title %}سجل الحضور - تعلمي في يدي{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="d-flex align-items-center justify-content-between mb-5 animate-fade-in">
        <div>
            <h1 class="h2 fw-bold text-primary mb-1">سجل الحضور والغياب</h1>
            <p class="text-muted mb-0">تابع أيام غيابك وتأخيرك</p>
        </div>
        <a href="{% url 'core:home' %}" class="btn btn-outline-secondary rounded-pill">
            <i class="fa-solid fa-arrow-right me-2"></i> الرئيسية
        </a>
    </div>

    <!-- Stats Cards -->
    <div class="row g-4 mb-5">
        <div class="col-md-4 animate-on-scroll delay-100">
            <div class="glass-card p-4 text-center h-100 border-bottom border-4 border-danger">
                <div class="mb-3">
                    <i class="fa-solid fa-user-xmark fa-3x text-danger opacity-50"></i>
                </div>
                <h3 class="display-4 fw-bold text-danger mb-0">{{ absences|length }}</h3>
                <p class="text-muted">أيام الغياب</p>
            </div>
        </div>
        <div class="col-md-4 animate-on-scroll delay-200">
            <div class="glass-card p-4 text-center h-100 border-bottom border-4 border-warning">
                <div class="mb-3">
                    <i class="fa-solid fa-clock fa-3x text-warning opacity-50"></i>
                </div>
                <h3 class="display-4 fw-bold text-warning mb-0">0</h3>
                <p class="text-muted">أيام التأخير</p>
            </div>
        </div>
        <div class="col-md-4 animate-on-scroll delay-300">
            <div class="glass-card p-4 text-center h-100 border-bottom border-4 border-success">
                <div class="mb-3">
                    <i class="fa-solid fa-user-check fa-3x text-success opacity-50"></i>
                </div>
                <h3 class="display-4 fw-bold text-success mb-0">95%</h3>
                <p class="text-muted">نسبة الالتزام</p>
            </div>
        </div>
    </div>

    <!-- Absence List -->
    <div class="glass-card p-4 animate-on-scroll">
        <h4 class="fw-bold mb-4 border-bottom pb-2">سجل الغياب التفصيلي</h4>
        {% if absences %}
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0" style="background: transparent;">
                    <thead class="bg-light bg-opacity-50">
                        <tr>
                            <th class="py-3 rounded-start-3">التاريخ</th>
                            <th class="py-3">اليوم</th>
                            <th class="py-3">السبب</th>
                            <th class="py-3 rounded-end-3">الحالة</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for absence in absences %}
                            <tr>
                                <td class="fw-bold text-primary">{{ absence.date }}</td>
                                <td>{{ absence.date|date:"l" }}</td>
                                <td>
                                    {% if absence.reason %}
                                        {{ absence.reason }}
                                    {% else %}
                                        <span class="text-muted opacity-50">غير محدد</span>
                                    {% endif %}
                                </td>
                                <td>
                                    <span class="badge bg-danger bg-opacity-10 text-danger px-3 py-2 rounded-pill">غياب</span>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <div class="text-center py-5">
                <div class="mb-3">
                    <i class="fa-solid fa-calendar-check fa-4x text-success opacity-25"></i>
                </div>
                <h4 class="text-success">سجلك نظيف!</h4>
                <p class="text-muted">لم يتم تسجيل أي غياب حتى الآن. أحسنت!</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
